<section class="new-task-page">
  <header class="new-task-page__header">
    <h1>{{ 'workato.newTask.title' | translate }}</h1>
    <p>{{ 'workato.newTask.subtitle' | translate }}</p>
  </header>

  <mat-card class="new-task-page__card">
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="new-task-page__form">
      <mat-form-field appearance="outline">
        <mat-label>{{ 'workato.newTask.fields.crew' | translate }}</mat-label>
        <mat-select formControlName="crewId" required>
          <mat-option *ngFor="let crew of (crews$ | async)" [value]="crew.id">
            {{ crew.name }} ({{ crew.status }})
          </mat-option>
        </mat-select>
        <mat-error *ngIf="form.controls.crewId.hasError('required')">
          {{ 'workato.newTask.validation.required' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>{{ 'workato.newTask.fields.agent' | translate }}</mat-label>
        <mat-select formControlName="agentId" required>
          <mat-option *ngFor="let agent of (agents$ | async)" [value]="agent.id">
            {{ agent.name }} â€¢ {{ agent.modelUsed }}
          </mat-option>
        </mat-select>
        <mat-error *ngIf="form.controls.agentId.hasError('required')">
          {{ 'workato.newTask.validation.required' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>{{ 'workato.newTask.fields.description' | translate }}</mat-label>
        <textarea matInput formControlName="description" rows="4" required></textarea>
        <mat-error *ngIf="form.controls.description.hasError('required')">
          {{ 'workato.newTask.validation.required' | translate }}
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>{{ 'workato.newTask.fields.estimatedTokens' | translate }}</mat-label>
        <input matInput type="number" formControlName="estimatedTokens" min="1" required />
        <mat-error *ngIf="form.controls.estimatedTokens.hasError('required')">
          {{ 'workato.newTask.validation.required' | translate }}
        </mat-error>
        <mat-error *ngIf="form.controls.estimatedTokens.hasError('min')">
          {{ 'workato.newTask.validation.min' | translate }}
        </mat-error>
      </mat-form-field>

      <div class="new-task-page__actions">
        <button mat-button type="button" (click)="onCancel()">{{ 'workato.newTask.actions.cancel' | translate }}</button>
        <button mat-flat-button color="primary" type="submit" [disabled]="isSubmitting()">
          {{ 'workato.newTask.actions.create' | translate }}
        </button>
      </div>
    </form>
  </mat-card>
</section>
